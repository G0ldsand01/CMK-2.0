---
import { Mail, MapPin, MessageSquare, Phone, Send } from 'lucide-react';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Textarea } from '@/components/ui/textarea';
import Layout from '../layouts/Layout.astro';
---

<Layout title="Contact Us" navbar={true}>
	<div class="max-w-6xl mx-auto px-4 py-20 pt-30">
		<div class="space-y-8">
			{/* Header */}
			<div class="text-center space-y-4">
				<h1 class="text-4xl font-bold tracking-tight">Get in Touch</h1>
				<p class="text-xl text-muted-foreground max-w-2xl mx-auto">
					We'd love to hear from you. Fill out the form below and we'll get back to you as soon as possible.
				</p>
			</div>

			<div class="grid gap-8 md:grid-cols-2">
				{/* Contact Information */}
				<div class="space-y-6">
					<Card>
						<CardHeader>
							<CardTitle>Contact Information</CardTitle>
							<CardDescription>
								Reach out to us through any of these channels
							</CardDescription>
						</CardHeader>
						<CardContent class="space-y-4">
							<div class="flex items-start gap-4">
								<div class="flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10 text-primary">
									<Mail class="size-5" />
								</div>
								<div>
									<h3 class="font-semibold mb-1">Email</h3>
									<p class="text-sm text-muted-foreground">
										Send us an email anytime
									</p>
									<a href="mailto:support@cmk.com" class="text-sm text-primary hover:underline">
										infocmkinc@gmail.com
									</a>
								</div>
							</div>

							<!-- <div class="flex items-start gap-4">
								<div class="flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10 text-primary">
									<Phone class="size-5" />
								</div>
								<div>
									<h3 class="font-semibold mb-1">Phone</h3>
									<p class="text-sm text-muted-foreground">
										Call us during business hours
									</p>
									<a href="tel:+1234567890" class="text-sm text-primary hover:underline">
										+1 (234) 567-890
									</a>
								</div>
							</div> -->

							<!-- <div class="flex items-start gap-4">
								<div class="flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10 text-primary">
									<MapPin class="size-5" />
								</div>
								<div>
									<h3 class="font-semibold mb-1">Address</h3>
									<p class="text-sm text-muted-foreground">
										123 Tech Street<br />
										Montreal, QC H1A 1A1<br />
										Canada
									</p>
								</div>
							</div> -->
						</CardContent>
					</Card>

					<Card>
						<CardHeader>
							<CardTitle>Business Hours</CardTitle>
						</CardHeader>
						<CardContent>
							<div class="space-y-2 text-sm">
								<div class="flex justify-between">
									<span class="text-muted-foreground">Monday - Friday</span>
									<span class="font-medium">9:00 AM - 6:00 PM</span>
								</div>
								<div class="flex justify-between">
									<span class="text-muted-foreground">Saturday</span>
									<span class="font-medium">10:00 AM - 4:00 PM</span>
								</div>
								<div class="flex justify-between">
									<span class="text-muted-foreground">Sunday</span>
									<span class="font-medium">Closed</span>
								</div>
							</div>
						</CardContent>
					</Card>
				</div>

				{/* Contact Form */}
				<Card>
					<CardHeader>
						<div class="flex items-center gap-2">
							<MessageSquare class="size-5" />
							<CardTitle>Send us a Message</CardTitle>
						</div>
						<CardDescription>
							Fill out the form below and we'll respond as soon as possible
						</CardDescription>
					</CardHeader>
					<CardContent>
						<form
							class="space-y-6"
							method="POST"
							action="https://formspree.io/f/xjkyjqap"
							id="contact-form"
						>
							<div class="space-y-2">
								<Label htmlFor="name">Name *</Label>
								<Input
									type="text"
									id="name"
									name="name"
									placeholder="Your full name"
									required
									minlength="2"
									maxlength="100"
								/>
							</div>

							<div class="space-y-2">
								<Label htmlFor="email">Email *</Label>
								<Input
									type="email"
									id="email"
									name="email"
									placeholder="your.email@example.com"
									required
								/>
							</div>

							<div class="space-y-2">
								<Label htmlFor="message">Message *</Label>
								<Textarea
									id="message"
									name="message"
									rows="6"
									placeholder="Tell us how we can help you..."
									required
									minlength="10"
								/>
							</div>

							<Button type="submit" class="w-full" size="lg">
								<Send class="size-4 mr-2" />
								Send Message
							</Button>
						</form>
					</CardContent>
				</Card>
			</div>
		</div>
	</div>
</Layout>

<script>
	const form = document.getElementById('contact-form') as HTMLFormElement;
	
	if (form) {
		form.addEventListener('submit', async (e) => {
			e.preventDefault();
			const formData = new FormData(form);
			const submitButton = form.querySelector('button[type="submit"]') as HTMLButtonElement;
			const originalText = submitButton.innerHTML;
			
			// Disable button and show loading state
			submitButton.disabled = true;
			submitButton.innerHTML = '<span class="mr-2">Sending...</span>';
			
			try {
				const response = await fetch(form.action, {
					method: 'POST',
					body: formData,
					headers: {
						'Accept': 'application/json'
					}
				});
				
				if (response.ok) {
					// Show success message
					submitButton.innerHTML = '<span class="mr-2">✓</span>Message Sent!';
					submitButton.classList.add('bg-green-500', 'hover:bg-green-600');
					form.reset();
					
					// Reset button after 3 seconds
					setTimeout(() => {
						submitButton.disabled = false;
						submitButton.innerHTML = originalText;
						submitButton.classList.remove('bg-green-500', 'hover:bg-green-600');
					}, 3000);
				} else {
					throw new Error('Failed to send message');
				}
			} catch (error) {
				// Show error message
				submitButton.innerHTML = '<span class="mr-2">✗</span>Error - Try Again';
				submitButton.classList.add('bg-red-500', 'hover:bg-red-600');
				
				// Reset button after 3 seconds
				setTimeout(() => {
					submitButton.disabled = false;
					submitButton.innerHTML = originalText;
					submitButton.classList.remove('bg-red-500', 'hover:bg-red-600');
				}, 3000);
			}
		});
	}
</script>
